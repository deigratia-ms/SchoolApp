<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Print Admission Letter</title>
  <style>
  /* Page setup for printing */
  @page {
    size: A4 portrait; /* Use 'letter' if preferred */
    margin: 0.5in;
  }

  @media print {
    /* Only print the print area */
    body * { visibility: hidden; }
    #printArea, #printArea * { visibility: visible; }
    #printArea { position: absolute; left: 0; top: 0; width: 100%; }
    /* Reset container visuals for clean print */
    .letter-container { border: none; box-shadow: none; padding: 0; margin: 0; width: 100%; max-width: 100%; }
  }

    /* Show page breaks properly */
    .page-break {
      page-break-before: always;
    }

    /* Letter-specific styling */
    .letter-header {
      margin-bottom: 1.5rem;
    }

    .letter-body {
      margin: 2rem 0;
      line-height: 1.5;
    }

    /* Prevent URL display */
    a:after {
      content: "" !important;
    }

    /* For best print layout */
    body {
      -webkit-print-color-adjust: exact !important;
      print-color-adjust: exact !important;
    }

    /* Slightly smaller elements to help fit in one page */
    .letter-header .school-name { font-size: 1.5rem; }
    .letter-body { font-size: 0.95rem; }

    /* Ensure logo scales well and is centered */
    .school-logo {
      max-height: 60px;
      max-width: 60px;
      display: block;
      margin: 0 auto 0.5rem auto;
    }
  

  /* Non-print styles */
  .letter-container {
    background-color: #fff;
    border: 1px solid #ddd;
    border-radius: 0.25rem;
    padding: 2rem;
    margin-bottom: 2rem;
    box-shadow: 0 0.125rem 0.25rem rgba(0, 0, 0, 0.075);
  }

  .letter-header {
    text-align: center;
    margin-bottom: 2rem;
    padding-bottom: 1rem;
    border-bottom: 2px solid #ddd;
  }

  .letter-header .school-name {
    font-size: 1.75rem;
    font-weight: bold;
    color: #333;
    text-transform: uppercase;
    margin-bottom: 0.5rem;
  }

  .letter-header .school-address {
    font-size: 0.875rem;
    color: #555;
    margin-bottom: 0.5rem;
  }

  .letter-header .school-contact {
    font-size: 0.875rem;
    color: #555;
  }

  .letter-ref {
    font-size: 0.875rem;
    margin-bottom: 1.5rem;
  }

  .letter-date {
    text-align: right;
    margin-bottom: 1.5rem;
  }

  .letter-body {
    font-size: 1rem;
    line-height: 1.6;
    margin-bottom: 2rem;
    text-align: justify;
  }

  .letter-body p {
    margin-bottom: 1rem;
  }

  .letter-signature {
    margin-top: 3rem;
    margin-bottom: 1.5rem;
  }

  .letter-signature .signature-image {
    max-height: 60px;
    margin-bottom: 0.5rem;
  }

  .letter-signature .signatory-name {
    font-weight: bold;
    margin-bottom: 0.25rem;
  }

  .letter-signature .signatory-title {
    font-style: italic;
    color: #555;
  }

  .school-logo {
    max-height: 80px;
    max-width: 80px;
    margin-bottom: 1rem;
  }

  .letter-footer {
    font-size: 0.75rem;
    color: #777;
    text-align: center;
    margin-top: 2rem;
    padding-top: 1rem;
    border-top: 1px solid #ddd;
  }

  /* Print controls */
  .print-controls {
    margin-bottom: 1.5rem;
  }
  </style>
</head>
<body>
  <div id="printArea" class="letter-container">
    <!-- Letter Header -->
    <div class="letter-header">
      <div style="text-align:center;">
        {% if school_settings.logo %}
        <img src="{{ school_settings.logo.url }}" alt="{{ school_settings.school_name }} Logo" class="school-logo" />
        {% endif %}
        <div class="school-name">{{ school_settings.school_name|default:"School Management System" }}</div>
        <div class="school-address">{{ school_settings.address|default:"School Address" }}</div>
        <div class="school-contact">
          {% if school_settings.phone %}Tel: {{ school_settings.phone }}{% endif %}
          {% if school_settings.email %} | Email: {{ school_settings.email }}{% endif %}
          {% if school_settings.website %} | {{ school_settings.website }}{% endif %}
        </div>
      </div>
    </div>

    <!-- Reference Number & Date -->
    <div style="display:flex; justify-content:space-between; font-size:0.95rem; margin-bottom:1rem;">
      <div class="letter-ref"><strong>Reference:</strong> {{ letter.reference_number }}</div>
      <div class="letter-date"><strong>Date:</strong> {{ letter.created_at|date:"F d, Y" }}</div>
    </div>

    <!-- Letter Body -->
    <div class="letter-body">{{ processed_body|safe }}</div>
  </div>
  {% if print_mode %}
  <script>
    window.onload = function () {
      setTimeout(function () { window.print(); }, 500);
    };
  </script>
  {% endif %}
</body>
</html>
